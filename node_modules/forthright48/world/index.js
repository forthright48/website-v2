(function(){
    "use strict";

    var path = require ( "path" );

    var root = path.join ( __dirname, "../../.." );
    var secret = require ( path.join ( root, "/secret.js" ) );
    var bcryptWorkLoad = 10;

    module.exports = {
        root: root,
        handleError: handleError,
        secret: secret,
        getLayoutContext: getLayoutContext,
        bcryptWorkLoad: bcryptWorkLoad

    };

    /*******************************************
    Implementation
    *******************************************/

    // Create an object wrapper for errors
    function handleError ( error, realError ) {
        return {
            subtitle: "error",
            error: error,
            realError: realError
        };
    }

    // Returns Context of Layout
    function getLayoutContext( req, subtitle ) {
        return {
            header: {
                isLoggedIn: req.session.isLoggedIn,
                username: req.session.username,
                subtitle: subtitle
            }
        };
    }

    // Automatically injects the context of layout
    function myRender ( req, res, view, context ) {
        context.layoutContext = getLayoutContext ( req, context.subtitle );

        return res.render ( view, context );
    }

}());
